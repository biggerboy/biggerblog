---
icon: mysql
category:
  - mysql
tag:
  - 常见问题
---

# MySQL常见问题汇总

## 索引

### 什么是索引？

索引就是一种用于快速查找数据的数据结构，是帮助MySQL高效获取数据的排好序的**数据结构**。

> 使用比较巧妙的数据结构，利用数据结构的特性来大大减少查找遍历次数

**优点：**

- 使用索引可以大大减少检索的数据量，从而加快数据的检索速度， 这也是创建索引的最主要的原因。
- 通过创建唯一性索引，可以保证数据库表中每一行数据的唯一性。

**缺点：**

- 创建索引和维护索引需要额外耗费时间。当对表中的数据进行增删改的时候，如果数据有索引，那么索引也需要动态的修改，会降低 SQL 执行效率。
- 索引需要使用物理文件存储，所以也会耗费一定磁盘空间。

但是，索引不是银弹，**使用索引也不一定百分之百提高查询性能。**如果数据量不大，那么使用索引也不一定能够带来很大提升，因为数据库的查询优化器会判断使用索引快还是全表扫描快，这不是我们能控制得了的。



### 索引使用的是哪种数据结构？

Hash索引、B+树索引。

### 为什么不使用二叉树或红黑树？

这里说的二叉树确切的说是二叉查找树，它在一定情况下会退化为链表。例如，如果我们依次插入1、2、3、4、5...，这样它就和链表没差了，复杂度为O（n）了，而我们通常数据库主键就是自增的，所以不使用二叉树作为索引。

![二叉树插入演示.gif](https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4ubmxhcmsuY29tL3l1cXVlLzAvMjAyMC9naWYvNDM3NjQyLzE1ODIyNjg2ODc1MzctNzZkMzNiYzUtNDNmOS00NjI5LThkY2UtMDA5ODE2NmEzMWQ4LmdpZg)

> 科普：
>
> 它的定义和特点如下：
>
> 二叉排序树（Binary Sort Tree），又称二叉查找树（Binary Search Tree），亦称二叉搜索树。是数据结构中的一类。 
>
> 具有下列性质：
>
> （1）若左子树不空，则左子树上所有结点的值均小于它的根结点的值；
>
> （2）若右子树不空，则右子树上所有结点的值均大于它的根结点的值；
>
> （3）左、右子树也分别为二叉排序树；



至于红黑树，它虽然通过自旋避免出现类似二叉树那样的情况，但是随着数据的不断增多，这棵树的高度会越来越高，而查询遍历的次数和树高有紧密的联系，基本是成正比的趋势。试想一下，一个表几百万的数据，如果使用红黑树作为索引，查询一个数据时，要遍历的次数也是很大的一个数字，而每次遍历对应到计算机上就是一次I/O交互，性能很低，所以没有采用这种数据结构。

  ![红黑树演示.gif](https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4ubmxhcmsuY29tL3l1cXVlLzAvMjAyMC9naWYvNDM3NjQyLzE1ODIyNzE3NTQ2ODEtY2RmOWZlNjUtMjVlNS00YjlhLWFiYzgtYjFhZTBlYTA5Zjc3LmdpZg)



### B+Tree和B-Tree有什么区别？

- B+Tree的叶子节点存放key和value，非叶子节点只有key，而B-树的所有节点既有key又有value

- B+树叶子节点之间有指针，B-树没有。非叶子节点之间跟B-Tree一样没有指针。

### B+树为什么把data元素挪到叶子节点？

非叶子节点只存储key，叶子节点存储了一份完整表的所有行的索引字段，value部分是每个索引元素对应的行记录的位置或行数据本身。这样非叶子节点的每个节点只存储key即索引，对于同一片大小的存储空间就可以存储更多的索引元素。

### B+树为什么把中间的元素提取出来做冗余索引？

目的是提高查找效率，类似于二分查找的思想。一个节点上的索引从左到右顺序递增，提取出中间值进行区间比较确定数据在哪个区间。 

### 什么是聚集索引和非聚集索引？

叶子节点包含了完整的数据记录的（节点的key为索引，value为完整的行数据）叫聚集索引（聚簇索引），InnoDB的主键索引就是一个聚集索引，他的索引和数据是在一个文件中。

叶子节点的data域存储的是主键值或行记录的内存地址的叫非聚集索引，存储引擎为MYISAM的表的索引类型为非聚集索引，它的索引和数据是分开存储的。

 ### 为什么InnoDB表必须有主键，并且推荐使用整型的自增主键？



 ### 建innoDB表的时候没有建主键，表也能建成功，为什么？



 ### 主键为什么推荐整形呢？ 为什么是自增的呢？



### MySQL一张表最多能存多少数据？



### 索引和数据存放位置？



### 存储引擎是修饰什么?



### 联合索引是怎么存储的？



### 索引不唯一时key对应的是个列表吗？



### 什么是最左前缀匹配原则？



### 什么是索引下推优化？

